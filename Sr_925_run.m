clc
clear all
close all
site_Number = 925;

Sr_925_main;

load('parameters_su_925.mat');
load('parameters_Ca_925.mat');

%% ============define parameters==============================
K_sr_sea = 0.194;    % Sr/Ca ratio in the solid over seawater

rho_s = 2.7;    % g/cm^3 ->g/m^3
rho_f = 1;      % g/cm^3 ->g/m^3

alpha=zz(1);
beta=zz(2);
gamma=zz(3);
v=zz(4);
gra_sr = zz(5); % gradient in fluids (zero gradient in solid)
% 
% alpha=0;
% beta=0.013;
% gamma=600;
% v=0;
% gra_sr = 0.008; % gradient in fluids (zero gradient in solid)
% 

gra_su = x925(6);
gra_ca = y925(6);

V=0;
Ks=x925(5);



t_step = 0.019221077571761;

z = [0;0.500000000000000;1;1.50000000000000;2;2.50000000000000;3;3.50000000000000;4;4.50000000000000;5;5.50000000000000;6;6.50000000000000;7;7.50000000000000;8;8.50000000000000;9;9.50000000000000;10;10.5000000000000;11;11.5000000000000;12;12.5000000000000;13;13.5000000000000;14;14.5000000000000;15;15.5000000000000;16;16.5000000000000;17;17.5000000000000;18;18.5000000000000;19;19.5000000000000;20;20.5000000000000;20.9900000000000;21.4800000000000;21.9700000000000;22.4600000000000;22.9500000000000;23.4500000000000;23.9500000000000;24.4400000000000;24.9300000000000;25.4300000000000;25.9300000000000;26.4300000000000;26.9300000000000;27.4300000000000;27.9300000000000;28.4300000000000;28.9300000000000;29.4300000000000;29.9300000000000;30.4300000000000;30.9300000000000;31.4300000000000;31.9300000000000;32.4200000000000;32.9100000000000;33.4000000000000;33.8900000000000;34.3800000000000;34.8700000000000;35.3600000000000;35.8500000000000;36.3400000000000;36.8300000000000;37.3200000000000;37.8100000000000;38.3000000000000;38.7900000000000;39.2800000000000;39.7700000000000;40.2600000000000;40.7500000000000;41.2400000000000;41.7300000000000;42.2200000000000;42.7000000000000;43.1800000000000;43.6600000000000;44.1400000000000;44.6200000000000;45.1000000000000;45.5800000000000;46.0600000000000;46.5400000000000;47.0200000000000;47.5000000000000;47.9800000000000;48.4600000000000;48.9400000000000;49.4200000000000;49.9000000000000;50.3900000000000;50.8800000000000;51.3600000000000;51.8500000000000;52.3300000000000;52.8200000000000;53.3100000000000;53.7900000000000;54.2800000000000;54.7600000000000;55.2500000000000;55.7400000000000;56.2200000000000;56.7100000000000;57.1900000000000;57.6800000000000;58.1700000000000;58.6500000000000;59.1400000000000;59.6300000000000;60.1100000000000;60.6000000000000;61.0800000000000;61.5700000000000;62.0600000000000;62.5400000000000;63.0300000000000;63.5100000000000;64.0000000000000;64.4800000000000;64.9600000000000;65.4400000000000;65.9200000000000;66.4000000000000;66.8800000000000;67.3500000000000;67.8200000000000;68.2900000000000;68.7600000000000;69.2300000000000;69.7000000000000;70.1700000000000;70.6400000000000;71.1100000000000;71.5800000000000;72.0500000000000;72.5200000000000;72.9900000000000;73.4600000000000;73.9300000000000;74.4000000000000;74.8700000000000;75.3400000000000;75.8100000000000;76.2800000000000;76.7500000000000;77.2200000000000;77.6900000000000;78.1600000000000;78.6300000000000;79.1100000000000;79.5800000000000;80.0500000000000;80.5200000000000;80.9900000000000;81.4700000000000;81.9400000000000;82.4100000000000;82.8800000000000;83.3600000000000;83.8300000000000;84.3000000000000;84.7700000000000;85.2400000000000;85.7200000000000;86.1900000000000;86.6600000000000;87.1300000000000;87.6100000000000;88.0800000000000;88.5500000000000;89.0200000000000;89.4900000000000;89.9700000000000;90.4400000000000;90.9100000000000;91.3800000000000;91.8600000000000;92.3300000000000;92.8000000000000;93.2700000000000;93.7400000000000;94.2100000000000;94.6600000000000;95.1300000000000;95.6000000000000;96.0500000000000;96.5100000000000;96.9700000000000;97.4400000000000;97.9100000000000;98.3800000000000;98.8500000000000;99.3000000000000;99.7700000000000;100.240000000000;100.690000000000;101.160000000000;101.630000000000;102.100000000000;102.550000000000;103.020000000000;103.490000000000;103.940000000000;104.410000000000;104.880000000000;105.350000000000;105.800000000000;106.270000000000;106.740000000000;107.190000000000;107.660000000000;108.130000000000;108.600000000000;109.050000000000;109.520000000000;109.990000000000;110.440000000000;110.910000000000;111.380000000000;111.850000000000;112.300000000000;112.770000000000;113.240000000000;113.690000000000;114.160000000000;114.630000000000;115.100000000000;115.550000000000;116.020000000000;116.490000000000;116.940000000000;117.410000000000;117.880000000000;118.350000000000;118.800000000000;119.270000000000;119.740000000000;120.190000000000;120.660000000000;121.130000000000;121.600000000000;122.050000000000;122.520000000000;122.990000000000;123.440000000000;123.890000000000;124.340000000000;124.790000000000;125.240000000000;125.690000000000;126.140000000000;126.590000000000;127.040000000000;127.490000000000;127.940000000000;128.390000000000;128.840000000000;129.290000000000;129.740000000000;130.190000000000;130.650000000000;131.100000000000;131.560000000000;132.010000000000;132.470000000000;132.930000000000;133.380000000000;133.840000000000;134.290000000000;134.750000000000;135.200000000000;135.660000000000;136.120000000000;136.570000000000;137.030000000000;137.480000000000;137.940000000000;138.400000000000;138.850000000000;139.310000000000;139.760000000000;140.220000000000;140.680000000000;141.130000000000;141.590000000000;142.040000000000;142.500000000000;142.960000000000;143.410000000000;143.870000000000;144.320000000000;144.780000000000;145.230000000000;145.690000000000;146.150000000000;146.600000000000;147.060000000000;147.510000000000;147.970000000000;148.430000000000;148.880000000000;149.340000000000;149.790000000000;150.250000000000;150.710000000000;151.160000000000;151.620000000000;152.070000000000;152.530000000000;152.980000000000;153.440000000000;153.900000000000;154.350000000000;154.810000000000;155.260000000000;155.720000000000;156.180000000000;156.630000000000;157.070000000000;157.510000000000;157.960000000000;158.400000000000;158.840000000000;159.280000000000;159.720000000000;160.160000000000;160.600000000000;161.040000000000;161.480000000000;161.920000000000;162.360000000000;162.800000000000;163.240000000000;163.680000000000;164.120000000000;164.560000000000;165.000000000000;165.440000000000;165.880000000000;166.320000000000;166.760000000000;167.200000000000;167.640000000000;168.080000000000;168.520000000000;168.960000000000;169.400000000000;169.840000000000;170.280000000000;170.720000000000;171.160000000000;171.600000000000;172.040000000000;172.480000000000;172.920000000000;173.360000000000;173.800000000000;174.240000000000;174.680000000000;175.120000000000;175.560000000000;176.000000000000;176.440000000000;176.880000000000;177.320000000000;177.760000000000;178.200000000000;178.640000000000;179.080000000000;179.520000000000;179.960000000000;180.400000000000;180.840000000000;181.280000000000;181.720000000000;182.160000000000;182.600000000000;183.040000000000;183.480000000000;183.920000000000;184.360000000000;184.800000000000;185.240000000000;185.680000000000;186.120000000000;186.560000000000;187.000000000000;187.440000000000;187.880000000000;188.320000000000;188.760000000000;189.200000000000;189.640000000000;190.080000000000;190.520000000000;190.960000000000;191.400000000000;191.840000000000;192.280000000000;192.720000000000;193.160000000000;193.600000000000;194.030000000000;194.460000000000;194.890000000000;195.320000000000;195.750000000000;196.180000000000;196.610000000000;197.040000000000;197.470000000000;197.900000000000;198.330000000000;198.760000000000;199.190000000000;199.620000000000;200.050000000000;200.480000000000;200.910000000000;201.340000000000;201.770000000000;202.200000000000;202.630000000000;203.060000000000;203.490000000000;203.920000000000;204.350000000000;204.780000000000;205.210000000000;205.640000000000;206.070000000000;206.500000000000;206.930000000000;207.360000000000;207.790000000000;208.220000000000;208.650000000000;209.080000000000;209.510000000000;209.940000000000;210.370000000000;210.800000000000;211.230000000000;211.660000000000;212.090000000000;212.520000000000;212.950000000000;213.380000000000;213.810000000000;214.240000000000;214.670000000000;215.100000000000;215.530000000000;215.960000000000;216.390000000000;216.820000000000;217.250000000000;217.680000000000;218.110000000000;218.540000000000;218.970000000000;219.400000000000;219.830000000000;220.260000000000;220.690000000000;221.120000000000;221.550000000000;221.980000000000;222.410000000000;222.840000000000;223.270000000000;223.700000000000;224.130000000000;224.560000000000;224.990000000000;225.420000000000;225.850000000000;226.280000000000;226.710000000000;227.140000000000;227.570000000000;228.000000000000;228.430000000000;228.860000000000;229.290000000000;229.720000000000;230.150000000000;230.580000000000;231.010000000000;231.440000000000;231.870000000000;232.300000000000;232.730000000000;233.160000000000;233.590000000000;234.020000000000;234.450000000000;234.880000000000;235.310000000000;235.740000000000;236.160000000000;236.580000000000;237.000000000000;237.420000000000;237.840000000000;238.260000000000;238.680000000000;239.100000000000;239.520000000000;239.940000000000;240.360000000000;240.780000000000;241.200000000000;241.620000000000;242.040000000000;242.460000000000;242.880000000000;243.300000000000;243.720000000000;244.140000000000;244.560000000000;244.980000000000;245.400000000000;245.820000000000;246.240000000000;246.660000000000;247.080000000000;247.500000000000;247.920000000000;248.340000000000;248.760000000000;249.180000000000;249.600000000000;250.020000000000;250.440000000000;250.860000000000;251.280000000000;251.700000000000;252.120000000000;252.540000000000;252.970000000000;253.400000000000;253.820000000000;254.250000000000;254.680000000000;255.100000000000;255.530000000000;255.960000000000;256.380000000000;256.800000000000;257.220000000000;257.640000000000;258.060000000000;258.480000000000;258.900000000000;259.320000000000;259.740000000000;260.160000000000;260.580000000000;261.000000000000;261.420000000000;261.840000000000;262.260000000000;262.680000000000;263.100000000000;263.520000000000;263.940000000000;264.360000000000;264.780000000000;265.200000000000;265.620000000000;266.040000000000;266.460000000000;266.880000000000;267.300000000000;267.720000000000;268.140000000000;268.560000000000;268.980000000000;269.400000000000;269.820000000000;270.240000000000;270.660000000001;271.080000000001;271.500000000001;271.920000000001;272.340000000001;272.760000000001;273.180000000001;273.600000000001;274.020000000001;274.440000000001;274.860000000001;275.280000000001;275.700000000001;276.120000000001;276.540000000001;276.960000000001;277.380000000001;277.800000000001;278.220000000001;278.640000000001;279.060000000001;279.480000000001;279.900000000001;280.320000000001;280.740000000001;281.160000000001;281.580000000001;282.000000000001;282.420000000001;282.840000000001;283.260000000001;283.680000000001;284.100000000001;284.510000000001;284.920000000001;285.330000000001;285.740000000001;286.150000000001;286.560000000001;286.970000000001;287.380000000001;287.790000000001;288.200000000001;288.610000000001;289.020000000001;289.430000000001;289.840000000001;290.250000000001;290.660000000001;291.070000000001;291.480000000001;291.890000000001;292.300000000002;292.710000000002;293.120000000002;293.530000000002;293.940000000002;294.350000000002;294.760000000002;295.170000000002;295.580000000002;295.990000000002;296.400000000002;296.810000000002;297.220000000002;297.630000000002;298.040000000002;298.450000000002;298.860000000002;299.270000000002;299.680000000002;300.090000000002;300.500000000002;300.910000000002;301.320000000002;301.730000000002;302.140000000002;302.550000000002;302.960000000002;303.370000000002;303.780000000002;304.190000000002;304.600000000002;305.010000000002;305.420000000002;305.830000000002;306.240000000002;306.650000000002;307.060000000002;307.470000000002;307.880000000002;308.290000000002;308.700000000003;309.110000000003;309.520000000003;309.930000000003;310.340000000003;310.750000000003;311.160000000003;311.570000000003;311.980000000003;312.390000000003;312.800000000003;313.210000000003;313.620000000003;314.030000000003;314.440000000003;314.850000000003;315.260000000003;315.670000000003;316.080000000003;316.490000000003;316.900000000003;317.310000000003;317.720000000003;318.130000000003;318.540000000003;318.950000000003;319.360000000003;319.770000000003;320.180000000003;320.590000000003;321.000000000003;321.410000000003;321.820000000003;322.230000000003;322.640000000003;323.050000000003;323.460000000003;323.870000000003;324.280000000003;324.690000000003;325.100000000004;325.510000000004;325.920000000004;326.330000000004;326.740000000004;327.150000000004;327.560000000004;327.970000000004;328.380000000004;328.790000000004;329.200000000004;329.610000000004;330.020000000004;330.430000000004;330.840000000004;331.250000000004;331.660000000004;332.070000000004;332.480000000004;332.890000000004;333.300000000004;333.710000000004;334.120000000004;334.530000000004;334.940000000004;335.350000000004;335.760000000004;336.170000000004;336.580000000004;336.990000000004;337.400000000004;337.810000000004;338.220000000004;338.630000000004;339.040000000004;339.450000000004;339.860000000004;340.260000000004;340.660000000004;341.060000000004;341.460000000004;341.860000000004;342.260000000004;342.660000000004;343.060000000004;343.460000000004;343.860000000004;344.260000000004;344.660000000004;345.060000000004;345.460000000004;345.860000000004;346.260000000004;346.660000000004;347.060000000004;347.460000000004;347.860000000004;348.260000000004;348.660000000004;349.060000000004;349.460000000004;349.860000000004;350.260000000004;350.660000000004;351.060000000004;351.460000000004;351.860000000004;352.260000000004;352.660000000004;353.060000000004;353.460000000004;353.860000000004;354.260000000004;354.660000000004;355.060000000004;355.460000000004;355.860000000004;356.260000000003;356.660000000003;357.060000000003;357.460000000003;357.860000000003;358.260000000003;358.660000000003;359.060000000003;359.460000000003;359.860000000003;360.260000000003;360.660000000003;361.060000000003;361.460000000003;361.860000000003;362.260000000003;362.660000000003;363.060000000003;363.460000000003;363.860000000003;364.260000000003;364.660000000003;365.060000000003;365.460000000003;365.860000000003;366.260000000003;366.660000000003;367.060000000003;367.460000000003;367.860000000003;368.260000000003;368.660000000003;369.060000000003;369.460000000003;369.860000000003;370.260000000003;370.660000000003;371.060000000003;371.460000000003;371.860000000003;372.260000000003;372.660000000003;373.060000000003;373.460000000003;373.860000000002;374.260000000002;374.660000000002;375.060000000002;375.460000000002;375.860000000002;376.260000000002;376.660000000002;377.060000000002;377.460000000002;377.860000000002;378.260000000002;378.660000000002;379.060000000002;379.460000000002;379.860000000002;380.260000000002;380.660000000002;381.060000000002;381.460000000002;381.860000000002;382.260000000002;382.660000000002;383.060000000002;383.460000000002;383.860000000002;384.260000000002;384.660000000002;385.060000000002;385.460000000002;385.860000000002;386.260000000002;386.660000000002;387.060000000002;387.460000000002;387.860000000002;388.260000000002;388.660000000002;389.060000000002;389.460000000002;389.860000000002;390.260000000002;390.660000000002;391.060000000002;391.460000000001;391.860000000001;392.260000000001;392.660000000001;393.060000000001;393.460000000001;393.860000000001;394.260000000001;394.660000000001;395.060000000001;395.460000000001;395.860000000001;396.260000000001;396.660000000001;397.060000000001;397.460000000001;397.860000000001;398.260000000001;398.660000000001;399.060000000001;399.460000000001;399.860000000001;400.260000000001;400.660000000001;401.060000000001;401.460000000001;401.860000000001;402.260000000001;402.660000000001;403.060000000001;403.460000000001;403.860000000001;404.260000000001;404.660000000001;405.060000000001;405.450000000001;405.840000000001;406.230000000001;406.620000000001;407.010000000001;407.400000000001;407.790000000001;408.180000000001;408.570000000001;408.960000000001;409.350000000001;409.740000000001;410.130000000001;410.520000000001;410.910000000001;411.300000000000;411.690000000000;412.080000000000;412.470000000000;412.860000000000;413.250000000000;413.640000000000;414.030000000000;414.420000000000;414.810000000000;415.200000000000;415.590000000000;415.980000000000;416.370000000000;416.760000000000;417.150000000000;417.540000000000;417.930000000000;418.320000000000;418.710000000000;419.100000000000;419.490000000000;419.880000000000;420.270000000000;420.660000000000;421.050000000000;421.440000000000;421.830000000000;422.220000000000;422.610000000000;423.000000000000;423.390000000000;423.780000000000;424.170000000000;424.560000000000;424.950000000000;425.340000000000;425.730000000000;426.120000000000;426.510000000000;426.900000000000;427.290000000000;427.680000000000;428.070000000000;428.460000000000;428.850000000000;429.240000000000;429.630000000000;430.020000000000;430.420000000000;430.810000000000;431.200000000000;431.590000000000;431.980000000000;432.370000000000;432.760000000000;433.150000000000;433.540000000000;433.930000000000;434.320000000000;434.710000000000;435.100000000000;435.490000000000;435.880000000000;436.270000000000;436.660000000000;437.050000000000;437.440000000000;437.830000000000;438.220000000000;438.610000000000;439.000000000000;439.390000000000;439.779999999999;440.169999999999;440.559999999999;440.949999999999;441.339999999999;441.729999999999;442.119999999999;442.509999999999;442.899999999999;443.289999999999;443.679999999999;444.069999999999;444.459999999999;444.849999999999;445.239999999999;445.629999999999;446.019999999999;446.409999999999;446.799999999999;447.189999999999;447.579999999999;447.969999999999;448.359999999999;448.749999999999;449.139999999999;449.529999999999;449.919999999999;450.309999999999;450.699999999999;451.089999999999;451.479999999999;451.869999999999;452.259999999999;452.649999999999;453.039999999999;453.429999999999;453.819999999999;454.209999999999;454.599999999999;454.989999999999;455.379999999999;455.769999999999;456.159999999999;456.549999999999;456.939999999999;457.329999999999;457.719999999999;458.109999999999;458.499999999999;458.889999999999;459.279999999999;459.669999999999;460.059999999999;460.449999999999;460.839999999999;461.229999999999;461.619999999999;462.009999999999;462.399999999999;462.789999999999;463.179999999999;463.569999999999;463.959999999999;464.349999999999;464.739999999999;465.129999999999;465.519999999999;465.909999999999;466.299999999999;466.689999999999;467.079999999999;467.469999999999;467.859999999999;468.249999999998;468.639999999998;469.029999999998;469.419999999998;469.809999999998;470.199999999998;470.589999999998;470.979999999998;471.369999999998;471.759999999998;472.149999999998;472.539999999998;472.929999999998;473.319999999998;473.709999999998;474.099999999998;474.489999999998;474.879999999998;475.269999999998;475.659999999998;476.049999999998;476.439999999998;476.829999999998;477.219999999998;477.609999999998;477.999999999998;478.389999999998;478.779999999998;479.169999999998;479.559999999998;479.949999999998;480.339999999998;480.729999999998;481.119999999998;481.509999999998;481.899999999998;482.289999999998;482.679999999998;483.059999999998;483.439999999998;483.819999999998;484.199999999998;484.579999999998;484.959999999998;485.339999999998;485.719999999998;486.099999999998;486.479999999998;486.859999999998;487.239999999998;487.619999999998;487.999999999998;488.379999999998;488.759999999998;489.139999999998;489.519999999998;489.899999999998;490.279999999998;490.659999999998;491.039999999998;491.419999999998;491.799999999998;492.179999999998;492.559999999998;492.939999999998;493.319999999998;493.699999999998;494.079999999998;494.459999999998;494.839999999998;495.219999999998;495.599999999998;495.979999999998;496.359999999998;496.739999999998;497.119999999998;497.499999999998;497.879999999998;498.259999999998;498.639999999998;499.019999999998;499.399999999998;499.779999999998;500.159999999998;500.539999999998;500.919999999998;501.299999999998;501.679999999998;502.059999999998;502.439999999998;502.819999999998;503.199999999998;503.579999999998;503.959999999998;504.339999999998;504.719999999998;505.099999999998;505.479999999998;505.859999999998;506.239999999998;506.619999999998;506.999999999998;507.379999999998;507.759999999998;508.139999999998;508.519999999998;508.899999999998;509.279999999998;509.659999999998;510.039999999998;510.419999999998;510.799999999998;511.179999999998;511.559999999998;511.939999999998;512.319999999998;512.699999999998;513.079999999998;513.459999999998;513.839999999998;514.219999999998;514.599999999998;514.979999999998;515.359999999998;515.739999999998;516.119999999998;516.499999999998;516.879999999998;517.259999999998;517.639999999998;518.019999999998;518.399999999998;518.779999999998;519.159999999998;519.539999999998;519.919999999998;520.299999999998;520.679999999998;521.059999999998;521.439999999998;521.819999999998;522.199999999998;522.579999999998;522.959999999998;523.339999999998;523.719999999998;524.099999999998;524.479999999998;524.859999999998;525.239999999998;525.619999999998;525.999999999998;526.379999999998;526.759999999998;527.139999999998;527.519999999998;527.899999999998;528.279999999998;528.659999999998;529.039999999998;529.419999999998;529.799999999998;530.179999999997;530.559999999997;530.939999999997;531.319999999997;531.699999999997;532.079999999997;532.459999999997;532.839999999997;533.219999999997;533.599999999997;533.979999999997;534.359999999997;534.739999999997;535.119999999997;535.499999999997;535.879999999997;536.259999999997;536.639999999997;537.019999999997;537.399999999997;537.779999999997;538.159999999997;538.539999999997;538.919999999997;539.299999999997;539.679999999997;540.059999999997;540.439999999997;540.819999999997;541.199999999997;541.579999999997;541.959999999997;542.339999999997;542.719999999997;543.099999999997;543.479999999997;543.859999999997;544.239999999997;544.619999999997;544.999999999997;545.379999999997;545.759999999997;546.139999999997;546.519999999997;546.899999999997;547.279999999997;547.659999999997;548.039999999997;548.419999999997;548.799999999997;549.179999999997;549.559999999997;549.939999999997;550.319999999997;550.699999999997;551.079999999997;551.459999999997;551.839999999997;552.219999999997;552.599999999997;552.979999999997;553.359999999997;553.739999999997;554.119999999997;554.499999999997;554.879999999997;555.259999999997;555.639999999997;556.019999999997;556.399999999997;556.779999999997;557.159999999997;557.539999999997;557.919999999997;558.299999999997;558.679999999997;559.059999999997;559.439999999997;559.819999999997;560.199999999997;560.579999999997;560.959999999997;561.339999999997;561.719999999997;562.099999999997;562.479999999997;562.859999999997;563.239999999997;563.619999999997;563.999999999997;564.379999999997;564.759999999997;565.139999999997;565.519999999997;565.899999999997;566.279999999997;566.659999999997;567.039999999997;567.419999999997;567.799999999997;568.179999999997;568.559999999997;568.939999999997;569.319999999997;569.699999999997;570.079999999997;570.459999999997;570.839999999997;571.219999999997;571.599999999997;571.979999999997;572.359999999997;572.739999999997;573.119999999997;573.499999999997;573.879999999997;574.259999999997;574.639999999997;575.019999999997;575.399999999997;575.779999999997;576.159999999997;576.539999999997;576.919999999997;577.289999999997;577.659999999997;578.029999999997;578.399999999997;578.769999999997;579.139999999997;579.509999999997;579.879999999997;580.249999999997;580.619999999997;580.989999999997;581.359999999997;581.729999999997;582.099999999997;582.469999999997;582.839999999997;583.209999999997;583.579999999997;583.949999999997;584.319999999997;584.689999999997;585.059999999997;585.429999999997;585.799999999997;586.169999999997;586.539999999997;586.909999999997;587.279999999997;587.649999999997;588.019999999997;588.389999999997;588.759999999997;589.129999999997;589.499999999997;589.869999999997;590.239999999997;590.609999999997;590.979999999997;591.349999999997;591.719999999997;592.089999999997;592.459999999997;592.829999999997;593.199999999997;593.569999999997;593.939999999997;594.309999999997;594.679999999997;595.049999999997;595.419999999997;595.789999999997;596.159999999997;596.529999999997;596.899999999997;597.269999999997;597.639999999997;598.009999999997;598.379999999997;598.749999999997;599.119999999997;599.489999999997;599.859999999997;600.229999999997;600.599999999997;600.969999999997;601.339999999997;601.709999999997;602.079999999997;602.449999999997;602.819999999997;603.189999999997;603.559999999997;603.929999999997;604.299999999997;604.669999999997;605.039999999997;605.409999999997;605.779999999997;606.149999999997;606.519999999997;606.889999999997;607.259999999997;607.629999999997;607.999999999997;608.369999999997;608.739999999997;609.109999999997;609.479999999997;609.849999999997;610.219999999997;610.589999999997;610.959999999997;611.329999999997;611.699999999997;612.069999999997;612.439999999997;612.809999999997;613.179999999997;613.549999999997;613.919999999997;614.289999999997;614.659999999997;615.029999999997;615.399999999997;615.769999999997;616.139999999997;616.509999999997;616.879999999997;617.249999999997;617.619999999997;617.989999999997;618.359999999997;618.729999999997;619.099999999997;619.469999999997;619.839999999997;620.209999999997;620.579999999997;620.949999999997;621.319999999997;621.689999999997;622.059999999997;622.429999999997;622.799999999998;623.169999999998;623.539999999998;623.909999999998;624.279999999998;624.649999999998;625.019999999998;625.389999999998;625.759999999998;626.129999999998;626.499999999998;626.869999999998;627.239999999998;627.609999999998;627.979999999998;628.349999999998;628.719999999998;629.089999999998;629.459999999998;629.829999999998;630.199999999998;630.569999999998;630.939999999998;631.309999999998;631.679999999998;632.049999999998;632.419999999998;632.789999999998;633.159999999998;633.529999999998;633.899999999998;634.269999999998];
z_step = [0;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.500000000000000;0.500000000000000;0.490000000000000;0.490000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.500000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.490000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.480000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.470000000000000;0.470000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.450000000000000;0.460000000000000;0.460000000000000;0.450000000000000;0.440000000000000;0.440000000000000;0.450000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.440000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.430000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.430000000000000;0.430000000000000;0.420000000000000;0.430000000000000;0.430000000000000;0.420000000000000;0.430000000000000;0.430000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.420000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.410000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.400000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.400000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.390000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.380000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000;0.370000000000000];

%------- initialize the paramter------
J = length(z);
N = J;

t = zeros(N,1);
for i = 2:N
    t(i) = t(i-1) + t_step;
end

f_a = 0;
f_b = 62.739/100;
f_c = 1/1E-03;
phi_z = f_a + f_b*exp(-z/f_c);  % porosity over depth
fc = 66.4/100 ; 

R_d = zeros(N,J);
R_net = zeros(N,J);
R_p = zeros(N,J);

for n = 1:N
    for j = 1:n
        R_net(n,j) = y925(2)+y925(3)*exp(-z(n-j+1)/y925(4));
    end
end


temp_T = z*0.02024 + 279.2;

K_sr = zeros(length(z),1);

for i = 1:length(z)
    %     K_sr(i) = exp(-4.38 + 1.71e3/temp_T(i)-4.22e5/temp_T(i)^2)-0.006;
    K_sr(i)=0.025;
end

D0 = zeros(length(z),1);
D = zeros(length(z),1);

for i = 1:length(z)
    D0(i) = (3.69+ 0.169 * (temp_T(i)-273.15)) * 3.65 * 24 * 36;
    D(i) = D0(i) / (1-log(phi_z(i)^2));
end

D_so4=1.53*D;

L = 0.5;
k_su = x925(3);
G0 = x925(2);  %[mM/1 porewater]  by fitting

% K_sp is from fitting data, fitting celestite
K_sp = zeros(J,1);
for i = 1 :J
    K_sp(i) = -0.003557 * z(i) + 20.73+0.5;
end


for n = 1:N
    for j = 1:n
        R_d (n,j) = alpha+beta*exp(-z(n-j+1)/gamma);
        R_p(n,j) = R_d(n,j) - R_net(n,j);
    end
end

%% =============read data====================

%read data
[Leg1,Site1,Topcm1,Botcm,Depthmbsf1,CalciumCamM,ChlorinityClmM,MagnesiumMgmM,pHpHna,SodiumNamM,StrontiumSruM,SulfateSO4mM,SilicaH4SiO4uM,AlkalinityALKmM,SalinitySALna] = importfile_water('water.xlsx');
index=(Site1==site_Number);
depth=Depthmbsf1(index);
Sr=StrontiumSruM(index);

depth2=Depthmbsf1(index);
Ca2_data=CalciumCamM(index);

[site_sr,depth_sr,age_sr,SrCaRatio_Solid] = importfile_Solid_Sr('SrCaSolid.xlsx');

indexsr=(site_sr==site_Number);
depth1=depth_sr(indexsr);
Solid_Sr=SrCaRatio_Solid(indexsr)*10; % convert m mole/mole to mM of solid Sr
Solid_Sr_T = transpose(interp1(depth1,Solid_Sr,z,'linear','extrap'));   % interpolate and extrapolate the Sr-depth data with Linear method

%% ==========Ca calculation and best fit===========

Ca_pore = zeros(N,J);        % Ca profile over space and time
Ca_sea = zeros(N,1);

for n = 1: N
    Ca_sea(n) = 10.62+0.161*t(n);
end

for n =1:N
    Ca_pore(n,n:n+1) = 10.62 + 0.161*t(N-n+1);
end

Ca_pore(2,1) = Ca_pore(2,2)+ z_step(2)* gra_ca;

for n = 2: N-1
    
    a10 = 2*D(n-2+1)*t_step/z_step(n-2+2)^2;
    b10 = t_step*v/z_step(n-2+2);
    
    Ca_pore(n+1,2) = ((a10-b10)*Ca_pore(n,2+1) + (a10+b10)*(Ca_pore(n, 3) + 2 * z_step(n)* gra_ca) + (1-a10)*Ca_pore(n-1,2) + 2*10*1000 * t_step * R_net(n-2+1) *fc* rho_s / rho_f * (1-phi_z(n-2+2)) / phi_z(n-2+2)) / (1+a10);
    
    for j = 3:n
        
        a1 = 2*D(n-j+1)*t_step/z_step(n-j+2)^2;
        b1 = t_step*v/z_step(n-j+2);
        
        Ca_pore(n+1,j) = ((a1-b1)*Ca_pore(n,j+1) + (a1+b1)*Ca_pore(n,j-1) + (1-a1)*Ca_pore(n-1,j) + 2*10*1000 * t_step * R_net(n-j+1) *fc* rho_s / rho_f * (1-phi_z(n-j+2)) / phi_z(n-j+2)) / (1+a1);
        
    end

end

Ca_pore(:,1)=Ca_pore(:,2);

k = zeros(N,J);     % Sr/Sr2+ coefficient between solid and pore water

for n = 1:N
    for j = 1: n
        k(n,j) = K_sr(n-j+1) * 10 / Ca_pore(n,j) *1000;
    end
end

%% =========== Sulfate reduction model ==========

G= zeros(N,J);
G(:,1) = G0;
G(1,2) = G0;

for i = 1:N
    G(i,i:i+1) = G0;
end

C_su=zeros(N,J);

%---------boundary condition of sulfate in the pore water---------
Sea_sulfate=zeros(N,1);
for i = 1: N
    Sea_sulfate(i) = -0.15 * t(i) + 28;
end

for i = 1:N
    C_su(i,i:i+1) = Sea_sulfate(N-i+1);      % initial value of sulfate in the pore water
end

C_su(:,1) = Sea_sulfate(end);

%% ============ Sr and Sulfate calculation ===========

C_s = zeros(N, J); % in solid (ppm)
C_f = zeros(N, J); % in pore fluid (ppm)


% -----------Initial / Boundary Conditions-----------------

seawater925 = ones(1,N);
solid0 = zeros(1,N);

for i = 1:N
    seawater925(i) = Ca_sea(i)*Solid_Sr_T(i)/10000/K_sr_sea;  % ppm -> mM
    solid0(i) = Solid_Sr_T(i);
end


K = zeros(N,1);     % Sr/Sr2+ coefficient between solid and seawater

for n = 1:N
    K(n) = K_sr_sea / Ca_sea(n)*10000;
end

% assume the initial condition of seawater


for i = 1:N
    C_s(i,i:i+1) = solid0(N-i+1);  %initial value at the lastest deposit carbonate solid
end
C_s(1,2) = solid0(N);

for i = 1:N
    C_f(i, i:i+1) = seawater925(N-i+1);  %initial value at the lastest pore water
end

C_f(2,1) = C_f(2,2)+z_step(2)* gra_sr;

% -----Calculate the first concentration in solid and pore water-

for n = 2:N-1
    
    a10 = 2*D(n-2+1)*t_step/z_step(n-2+2)^2;
    a10_so4 = 2*D_so4(n-2+1)*t_step/z_step(n-2+2)^2;
    b10 = t_step*v/z_step(n-2+2);
    b20 = 2*V*t_step/z_step(n-2+2);
    
    a20 = 2*t_step*R_p(n-1,2)*rho_s/rho_f*(1-phi_z(n-2+2))/phi_z(n-2+2);  % attention the z(2) always represent the bottom
    a30 = R_d(n-1,2)*2*t_step;
    
    %     C_f(n,2-1) = C_f(n,2+1)+ 2*z_step(n)* gra_sr;
    %     C_su(n, 2-1) = C_su(n, 2+1)+ 2 * z_step(n)* gra_su;
    
    C_f(n+1,2) = (a10*C_f(n,2+1)+a10*C_f(n,2-1) + (1-a10-a20*k(n-1,2))*C_f(n-1,2) + 2*t_step*R_d(n-1,2)*rho_s/rho_f*(1-phi_z(n-2+2))/phi_z(n-2+2)*C_s(n-1,2)) / (1+a10);
    C_s(n+1,2) = (1-a30)*C_s(n-1,2) + R_p(n-1,2)*2*t_step*k(n-1,2)*C_f(n-1,2);
    
    C_su(n+1,2) = ((a10_so4-b10)*C_su(n,2+1)+(a10_so4+b10)*(C_su(n, 3)+ 2 * z_step(n)* gra_su)+(1-a10_so4)*C_su(n-1,2)-2*t_step*k_su*L*G(n-1,2)*C_su(n-1,2)/(C_su(n-1,2)+Ks))/(1+a10_so4);
    G(n+1,2) = G(n-1,2) * (1 - 2*k_su*t_step*C_su(n-1,2)/(Ks +C_su(n-1,2)));
    
    if C_su(n+1,2) < 0
        C_su(n+1,2) = 0;
    end
    
    for j = 3:n
        
        a1 = 2*D(n-j+1)*t_step/z_step(n-j+2)^2;
        a1_so4 = 2*D_so4(n-j+1)*t_step/z_step(n-j+2)^2;
        b1 = t_step*v/z_step(n-j+2);
        b2 = 2*V*t_step/z_step(n-j+2);
        
        a2 = 2*t_step*R_p(n-1,j)*rho_s/rho_f*(1-phi_z(n-j+2))/phi_z(n-j+2);  % attention the z(2) always represent the bottom
        a3 = R_d(n-1,j)*2*t_step;
        
        C_f(n+1,j) = (a1*C_f(n,j+1)+a1*C_f(n,j-1) + (1-a1-a2*k(n-1,j))*C_f(n-1,j) + 2*t_step*R_d(n-1,j)*rho_s/rho_f*(1-phi_z(n-j+2))/phi_z(n-j+2)*C_s(n-1,j)) / (1+a1);
        C_s(n+1,j) = (1-a3)*C_s(n-1,j) + R_p(n-1,j)*2*t_step*k(n-1,j)*C_f(n-1,j);
        
        C_su(n+1,j) = ((a1_so4-b1)*C_su(n,j+1)+(a1_so4+b1)*C_su(n,j-1)+(1-a1_so4)*C_su(n-1,j)-2*t_step*k_su*L*G(n-1,j)*C_su(n-1,j)/(C_su(n-1,j)+Ks))/(1+a1_so4);
        G(n+1,j) = G(n-1,j) * (1 - 2*k_su*t_step*C_su(n-1,j)/(Ks +C_su(n-1,j))) - b2 * G(n,j+1) + b2 * G(n,j-1);
        
        if C_su(n+1,j) < 0
            C_su(n+1,j) = 0;
        end
        % judge the precipitation of SrSO4
        
%         if C_su(n+1,j) * C_f(n+1,j)  >=  K_sp(n+1-j+1)
%             C_f(n+1,j) = K_sp(n+1-j+1)/C_su(n+1,j);
%         end
    end
    
    C_f(n+1,1) = C_f(n+1,3) + 2*z_step(n+1)* gra_sr;
    C_s(n+1,1) = C_s(n+1,3);
    C_su(n+1,1) = C_su(n+1,3) + 2*z_step(n+1)* gra_su;
    
end

%% =========== simulate the best fit of seawater ==============
number_loops = 2;
Dif=zeros(1,J);
for p = 1:number_loops
    for pp = 1:J
        Dif(pp) = (Solid_Sr_T(pp) - C_s(N,J-pp+1))/K(pp);
    end
    seawater925 = seawater925 + Dif;
    
    
    %re-initialize
    
    G= zeros(N,J);
    G(:,1) = G0;
    G(1,2) = G0;
    
    for i = 1:N
        G(i,i:i+1) = G0;
    end
    
    C_su=zeros(N,J);
    
    %---------boundary condition of sulfate in the pore water---------
    Sea_sulfate=zeros(N,1);
    for i = 1: N
        Sea_sulfate(i) = -0.15 * t(i) + 28;
    end
    
    for i = 1:N
        C_su(i,i:i+1) = Sea_sulfate(N-i+1);      % initial value of sulfate in the pore water
    end
    
    C_su(:,1) = Sea_sulfate(end);
    
    C_s = zeros(N, J); % in solid (ppm)
    C_f = zeros(N, J); % in pore fluid (ppm)
    
    
    %end re-initialize
    
    
    K = zeros(N,1);     % Sr/Sr2+ coefficient between solid and seawater
    
    for n = 1:N
        K(n) = K_sr_sea / Ca_sea(n)*10000;
    end
    
    for i = 1:N
        solid0(i) = K (i) * seawater925(i);
    end
    
    for i = 1:N
        C_s(i,i:i+1) = solid0(N-i+1);  %initial value in solid
    end
    C_s(1,2)=solid0(N);
    
    for i = 1:N
        C_f(i, i:i+1) = seawater925(N-i+1);  %initial value at the lastest pore water
    end
    
    C_f(2,1) = C_f(2,2)+z_step(2)* gra_sr;
    
    for n = 2:N-1
        
        a10 = 2*D(n-2+1)*t_step/z_step(n-2+2)^2;
        a10_so4 = 2*D_so4(n-2+1)*t_step/z_step(n-2+2)^2;
        b10 = t_step*v/z_step(n-2+2);
        b20 = 2*V*t_step/z_step(n-2+2);
        
        a20 = 2*t_step*R_p(n-1,2)*rho_s/rho_f*(1-phi_z(n-2+2))/phi_z(n-2+2);  % attention the z(2) always represent the bottom
        a30 = R_d(n-1,2)*2*t_step;
        
        %         C_f(n,2-1) = C_f(n,2+1)+ 2*z_step(n)* gra_sr;
        %         C_su(n, 2-1) = C_su(n, 2+1)+ 2 * z_step(n)* gra_su;
        
        C_f(n+1,2) = (a10*C_f(n,2+1)+a10*C_f(n,2-1) + (1-a10-a20*k(n-1,2))*C_f(n-1,2) + 2*t_step*R_d(n-1,2)*rho_s/rho_f*(1-phi_z(n-2+2))/phi_z(n-2+2)*C_s(n-1,2)) / (1+a10);
        C_s(n+1,2) = (1-a30)*C_s(n-1,2) + R_p(n-1,2)*2*t_step*k(n-1,2)*C_f(n-1,2);
        
        C_su(n+1,2) = ((a10_so4-b10)*C_su(n,2+1)+(a10_so4+b10)*(C_su(n, 3)+ 2 * z_step(n)* gra_su)+(1-a10_so4)*C_su(n-1,2)-2*t_step*k_su*L*G(n-1,2)*C_su(n-1,2)/(C_su(n-1,2)+Ks))/(1+a10_so4);
        G(n+1,2) = G(n-1,2) * (1 - 2*k_su*t_step*C_su(n-1,2)/(Ks +C_su(n-1,2)));
        
        if C_su(n+1,2) < 0
            C_su(n+1,2) = 0;
        end
        
        for j = 3:n
            
            a1 = 2*D(n-j+1)*t_step/z_step(n-j+2)^2;
            a1_so4 = 2*D_so4(n-j+1)*t_step/z_step(n-j+2)^2;
            b1 = t_step*v/z_step(n-j+2);
            b2 = 2*V*t_step/z_step(n-j+2);
            
            a2 = 2*t_step*R_p(n-1,j)*rho_s/rho_f*(1-phi_z(n-j+2))/phi_z(n-j+2);  % attention the z(2) always represent the bottom
            a3 = R_d(n-1,j)*2*t_step;
            
            C_f(n+1,j) = (a1*C_f(n,j+1)+a1*C_f(n,j-1) + (1-a1-a2*k(n-1,j))*C_f(n-1,j) + 2*t_step*R_d(n-1,j)*rho_s/rho_f*(1-phi_z(n-j+2))/phi_z(n-j+2)*C_s(n-1,j)) / (1+a1);
            C_s(n+1,j) = (1-a3)*C_s(n-1,j) + R_p(n-1,j)*2*t_step*k(n-1,j)*C_f(n-1,j);
            
            C_su(n+1,j) = ((a1_so4-b1)*C_su(n,j+1)+(a1_so4+b1)*C_su(n,j-1)+(1-a1_so4)*C_su(n-1,j)-2*t_step*k_su*L*G(n-1,j)*C_su(n-1,j)/(C_su(n-1,j)+Ks))/(1+a1_so4);
            G(n+1,j) = G(n-1,j) * (1 - 2*k_su*t_step*C_su(n-1,j)/(Ks +C_su(n-1,j))) - b2 * G(n,j+1) + b2 * G(n,j-1);
            
            if C_su(n+1,j) < 0
                C_su(n+1,j) = 0;
            end
%             judge the precipitation of SrSO4
            
%             if C_su(n+1,j) * C_f(n+1,j)  >=  K_sp(n+1-j+1)
%                 C_f(n+1,j) = K_sp(n+1-j+1)/C_su(n+1,j);
%             end
        end
        
        C_f(n+1,1) = C_f(n+1,3) + 2*z_step(n+1)* gra_sr;
        C_s(n+1,1) = C_s(n+1,3);
        C_su(n+1,1) = C_su(n+1,3) + 2*z_step(n+1)* gra_su;
        
    end
    
    
end


%% ------- Chemical Porosity Calculation ----------
phi_che = zeros(length(t),length(z));    % Chemcial Porosity
for n = 1:length(t)
    for j = 1:n
        phi_che(n,j) = phi_z(n-j+1) - (1 - (1 - phi_z(n-j+1)) * (1 - 0 * R_net(n,j) * t_step) / (1 - R_d(n,j) * t_step));
    end
end

phi_test =  sum(phi_che,1);
phi_che_plot = phi_z(1)*ones(length(z),1) - transpose(phi_test);

%% ------------------- plot figures ---------------
t_total = t(end);
t1 = round((t_total - 25)/t_step);
t2 = round((t_total - 20)/t_step);
t3 = round((t_total - 15)/t_step);

figure
plot(fliplr(C_f(N,2:J)),z(2:J),'linewidth',2);
set(gca,'Ydir','reverse');  %reverse depth axis
hold on
plot(fliplr(C_f(N-t1,1:J-t1)),z(1+t1:end),'--','linewidth',2)
plot(fliplr(C_f(N-t2,1:J-t2)),z(1+t2:end),':','linewidth',2)
plot(fliplr(C_f(N-t3,1:J-t3)),z(1+t3:end),'-.','linewidth',2)

scatter(Sr/1000,depth,'ko')      % convert from muM to mM
title('Site 925');
xlabel('Sr in pore water (mM)');
ylabel('Present-day depth (m)')
set(gca,'FontSize',12)
legend('t=29.4 m.y.','t=25 m.y.','t=20 m.y.','t=15 m.y.','Sr^{2+} Data','location','SouthWest')
print('Sr925.jpg','-djpeg','-r600');

%--------
figure;
plot(fliplr(C_s(N,2:J))/10,z(2:J),'linewidth',2);
set(gca,'Ydir','reverse');  %reverse depth axis
hold on
scatter(Solid_Sr/10,depth1,'ko')

plot(solid0(1:end-2)/10,z(1:end-2),'--','linewidth',2);

title('Site 925');
xlabel('Sr/Ca in solid carbonate (mM/M)');
ylabel('Present-day depth (m)')
set(gca,'FontSize',12)
legend('Sr/Ca after diagenesis','Sr/Ca measured','Sr/Ca in depositional solid','location','NorthWest');
print('solid925.jpg','-djpeg','-r600');

%--------
figure;
seawater_ca = zeros(N,1);
for i = 1:N
    seawater_ca (i) = seawater925(i)/Ca_sea(i);
end
plot(t(1:end-2),seawater_ca(1:end-2)*1000,'linewidth',2)      %convect Sr/Ca mM/mM to uM/mM

% seawater data from paper (Coggon 2010, green line)
Time00=[0.821917808000000;3.01369863000000;6.02739726000000;8.76712328800000;11.5068493200000;13.6986301400000;19.7260274000000;25.2054794500000;29.8630137000000;32.6027397300000;34.7945205500000;37.5342465800000;41.0958904100000;44.3835616400000;47.9452054800000;50.6849315100000;52.8767123300000;55.0684931500000;57.2602739700000;61.3698630100000];
seawater_ca_data=[9.03943412500000;9.20790650400000;8.37112027000000;8.37221353700000;8.65263641200000;8.65351102600000;8.37658660300000;8.15530944900000;8.04543615900000;7.82306573800000;7.71220850800000;7.65743585300000;7.54712525600000;7.66016901900000;7.82918803100000;7.77441537600000;7.66355814500000;7.94376236800000;8.50329619900000;8.72839978600000];
seawater00=seawater_ca_data*1.03/100;    % convect Sr/Ca mMol/Mol to mM Sr in seawater

hold on
scatter(Time00,seawater_ca_data,'ko')

title('Sr/Ca in seawater vs time (m.y.)');
xlabel('Time (m.y.)');
ylabel('Sr/Ca (\muM/mM) in seawater')
set(gca,'FontSize',12)

% pick sample to output

data_index=[];  % sample index
for ii = 1:length(depth1)
    
    for jj = 1:(length(z)-1)
        
        if z (jj) <= depth1 (ii) && z (jj+1) > depth1 (ii)
            data_index = [data_index,jj];
        end
    end
end

% data output corresponds to the collected solid samples
t_output = t(data_index);
seawater_output = seawater925(data_index);

seawater_ca_output =seawater_ca(data_index);

scatter(t_output,seawater_ca_output*1000,'r*')

legend('Simulated Sr/Ca','Data collected from foraminifera','Selected output from simulation')

%---------
figure;
plot(fliplr(C_su(N,1:J)),z(1:N),'linewidth',2)
hold on
plot(fliplr(C_su(N-t1,1:J-t1)),z(1+t1:end),'--','linewidth',2)
plot(fliplr(C_su(N-t2,1:J-t2)),z(1+t2:end),':','linewidth',2)
plot(fliplr(C_su(N-t3,1:J-t3)),z(1+t3:end),'-.','linewidth',2)
set(gca,'Ydir','reverse')
title('Sulfate in pore water (site: 925)')
xlabel('Sulfate (mM)');
ylabel('Depth (m)')
set(gca,'FontSize',12)

index3=(Site1==site_Number & SulfateSO4mM >0);
depth3=Depthmbsf1(index3);
sulfate_data=SulfateSO4mM(index3);

scatter(sulfate_data,depth3,'ko')
legend('t=29.4 m.y.','t=25 m.y.','t=20 m.y.','t=15 m.y.','Sulfate Data')

% ---------
figure
plot(fliplr(Ca_pore(N,1:J)),z,'linewidth',2)
hold on
plot(fliplr(Ca_pore(N-t1,1:J-t1)),z(1+t1:end),'--','linewidth',2)
plot(fliplr(Ca_pore(N-t2,1:J-t2)),z(1+t2:end),':','linewidth',2)
plot(fliplr(Ca_pore(N-t3,1:J-t3)),z(1+t3:end),'-.','linewidth',2)

set(gca,'Ydir','reverse')
scatter (Ca2_data,depth2,'ko');
title('Calcium in pore water (site: 925)')
xlabel('Calcium (mM)');
ylabel('Depth (m)')
set(gca,'FontSize',12)

legend('t=29.4 m.y.','t=25 m.y.','t=20 m.y.','t=15 m.y.','Calcium Data')

% --------

figure;
plot(phi_z,z,'linewidth',2);
hold on
plot(flipud(phi_che_plot),z,'--','linewidth',2)
plot(phi_z(1)*ones(length(z),1),z,':','linewidth',2)
set(gca,'Ydir','reverse')
title('Site 925')
xlabel('Porosity');
ylabel('Present-day depth (m)')
legend('Final porosity','Porosity after chemical compaction','Initial depositional porosity','location','NorthWest')
set(gca,'FontSize',12)

% -------

% mul_res = zeros(N,J);
% for n = 1: N
%     for i = 1:J
%         mul_res (n,i) = C_su(n,i) * C_f(n,i);
%     end
% end
% figure
% plot(mul_res(N,:),z(end)-z(1:J),'b');
% set(gca,'Ydir','reverse')
% hold on
% plot(mul_res(N-81,1:J-81),z(end)-z(1+81:J),'r');
% plot(mul_res(N-165,1:J-165),z(end)-z(1+165:J),'g');
% plot(mul_res(N-248,1:J-248),z(end)-z(1+248:J),'m');
% plot(K_sp,z)
% legend('t=39.8 m.y.','t=35 m.y.','t=30 m.y.','t=25 m.y.')

%% ---- fraction of recrystallized calcite------

figure;
Rec_fra = fliplr(sum(R_d)*t_step*100); % in percentage (%)
plot(Rec_fra,z,'linewidth',2);
set(gca,'Ydir','reverse');  %reverse depth axis

xlabel('Fraction of recrystallized calcite (%)')
ylabel('Present-day depth (m)');
title('Site 925')
set(gca,'FontSize',12)


Ksr925=fliplr(C_s(N,1:J))/10.*fliplr(Ca_pore(N,1:J))./fliplr(C_f(N,1:J))/1000

figure;
plot(Ksr925,z,'LineWidth',2);

set(gca,'Ydir','reverse');  %reverse depth axis
hold on
title('Site 925');
xlabel('[Sr/Ca]_s/[Sr/Ca]_f');
ylabel('Present-day depth (m)');
print('Ksr925.jpg','-djpeg','-r600');

newName = 'Sr925';
S.(newName) = seawater_ca_output;

newName = 't925';
S.(newName) = t_output;

newName = 'Re925';
S.(newName) = Rec_fra;

newName = 'z925';
S.(newName) = z;

newName = 'Rnet925';
S.(newName) = fliplr(R_net(N,:));

newName = 'Rd925';
S.(newName) = fliplr(R_d(N,:));

newName = 'Ksr925';
S.(newName) = Ksr925;

save('data925.mat', '-struct', 'S'); 

save('seawater925.mat','seawater925');


newName = 'fitSr_no_celestite_Ksr2';
S.(newName) = fliplr(C_f(N,1:J));
save('parameters_sr_no_celestite_925_Ksr2.mat', '-struct', 'S'); 
